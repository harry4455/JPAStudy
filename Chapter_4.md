# Chapter 4. 엔티티 매핑

JPA 사용에 있어 가장 중요한 일은 엔티티와 테이블을 정확히 매핑하는 것.
따라서 매핑 어노테이션 숙지가 필요

- 객체와 테이블 매핑 : @Entity, @Table
- 기본 키 매핑 : @Id
- 필드와 컬럼 매핑 : @ Column
- 연관관계 매핑 : @ManyToOne, @JoinColumn

## 4.1 @Entity

JPA를 사용해서 테이블과 매핑할 클래서는 @Entity 어노테이션을 필수로 붙어야 한다.
어노테이션이 붙으면 해당 클래스는 JPA가 관리한다는 의미

|속성|기능|기본값|
|:---|:---|:---|
|name|PA에서 사용할 엔티티의 이름을 지정. 기본값인 클래스의 이름을 사용. 다른 클래스와 이름이 겹치지 않도록 주의 필요.|설정하지 않으면 클래스 명대로 따라감|

#주의사항
기본 생성자는 필수
final 클래스, enum, interface, inner 클래스에는 사용 불가
저장할 필드에 final 사용하면 안됨

## 4.2 @Table

엔티티와 매핑할 테이블을 지정
생략하면 매핑한 엔티티 이름을 테이블 명으로 사용한다

|속성|기능|기본값|
|:---|:---|:---|
|name|매핑할 테이블 이름|엔티티 이름을 사용|
|catalog|catalog 기능이 있는 DB에서 catalog 매핑||
|schema|schema 기능이 있는 DB에서 schema 매핑||
|uniqueConstraints(DDL)|DDL 생성 시에 유니크 제약조건을 만든다. 2개 이상의 복합 유니크 제약조건도 만들 수 있음. DDL을 만들때만 사용||

## 4.3 다양한 매핑 사용

## 4.4 데이터베이스 스키마 자동 생성

JPA는 매핑정보와 데이터베이스 방언을 사용해서 데이터베이스 스키마를 생성함
스키마 자동 생성 기능 (hibernate.hbm2ddl.auto)
애플리케이션 실행 시점에 데이터베이스 테이블을 자동으로 생성

그러나 운영환경에서 사용할 만큼 DDL이 완벽하지 않으므로 개발 환경에서 사용하거나 매핑을 할때 참고정도로 보는 것이 좋음.

|옵션|설명|
|:---|:---|
|create|기존 테이블을 삭제하고 새로 생성 (DROP + CREATE)|
|create-drop|create 속성에 추가로 애플리케이션 종료 시 생성상 DDL을 제거|
|update|DB 테이블과 에티티 매핑 정보를 비교해서 변경 사항만 수정|
|validate|DB 텡블과 엔티티 매핑정보를 비교해서 차이가 있으면 경고를 남기고 애플리케이션을 실행하지 않음. DDL 수정 안함|
|none|자동 생성 기능을 사용하지 않으려면 속성 자체를 삭제하거나 유효하지 않은 옵션 값을 주면 됨|
|update|DB 테이블과 에티티 매핑 정보를 비교해서 변경 사항만 수정|

## 4.5 DDL 생성 기능

스키마 자동 생성하기를 통해 만들어지는 DDL에 제약조건이 추가되는 경우

ex) not null 조건, varchar 크기 조건

-> 이러한 기능들은 DDL 생성할 때만 사용되고 JPA의 실행 로직에는 영향을 주지 않음

## 4.6 기본 키 매핑

